@startuml COOKie_System_Context_C4_Level1
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

LAYOUT_WITH_LEGEND()

title System Context Diagram for COOKie Platform (C4 Level 1)

' Персоны
Person(user_b2c, "B2C Пользователь", "Миллениалы/зумеры, желающие питаться правильно, но экономящие время")
Person(user_admin, "Контент-менеджер", "Модерирует и создает контент, управляет базой рецептов")
Person(user_analyst, "Аналитик/Маркетолог", "Анализирует метрики продукта, проводит A/B тесты")
Person(partner_manager, "B2B Партнер", "Представитель ритейлера (X5, ВкусВилл, Сбермаркет)")

' Основная система
System(cookie_platform, "COOKie Platform", "Комплексная платформа для планирования питания с ИИ-диетологом и интеграцией доставки готовой еды")

' Внешние системы - источники данных
System_Ext(recipe_sites, "Сайты рецептов", "1000.menu, tableofgods.com, EdimDoma.ru, Поваренок.ру")
System_Ext(video_platforms, "Видео-платформы", "TikTok API, YouTube API, Instagram API для парсинга видео-рецептов")
System_Ext(nutrition_db, "Базы данных нутриентов", "USDA FoodData Central, Роспотребнадзор БД продуктов")

' Внешние системы - партнеры доставки
System_Ext(x5_group, "X5 Group API", "Пятерочка, Перекресток - доставка готовой еды")
System_Ext(vkusvill, "ВкусВилл API", "Доставка здоровых продуктов и готовой еды")
System_Ext(sbermarket, "Сбермаркет API", "Маркетплейс продуктов питания")
System_Ext(samokat, "Самокат API", "Быстрая доставка продуктов")

' Внешние системы - ИИ и ML
System_Ext(openai, "OpenAI API", "GPT-4 для чат-бота ИИ-диетолога")
System_Ext(anthropic, "Anthropic Claude API", "Claude для альтернативных консультаций (опционально)")

' Внешние системы - платежи и аутентификация
System_Ext(payment_gateway, "Платежный шлюз", "ЮKassa, CloudPayments для обработки подписок")
System_Ext(oauth_providers, "OAuth провайдеры", "Yandex ID, VK ID, Google OAuth для аутентификации")

' Внешние системы - аналитика
System_Ext(analytics_systems, "Системы аналитики", "Google Analytics, Amplitude, Mixpanel")
System_Ext(monitoring, "Мониторинг", "Sentry (ошибки), Prometheus/Grafana (метрики)")

' Внешние системы - коммуникации
System_Ext(email_service, "Email сервис", "SendGrid / Mailgun для email-уведомлений")
System_Ext(push_service, "Push Notifications", "Firebase Cloud Messaging для мобильных push")
System_Ext(sms_service, "SMS Gateway", "Twilio / SMSC.ru для SMS-уведомлений")

' Основные связи - пользователи
Rel(user_b2c, cookie_platform, "Ищет рецепты, планирует питание, получает рекомендации ИИ, заказывает еду", "HTTPS/Mobile App")
Rel(user_admin, cookie_platform, "Модерирует рецепты, управляет контентом", "HTTPS/Admin Panel")
Rel(user_analyst, cookie_platform, "Просматривает аналитику, настраивает A/B тесты", "HTTPS/Analytics Dashboard")
Rel(partner_manager, cookie_platform, "Управляет каталогом готовой еды, получает аналитику заказов", "HTTPS/Partner Portal")

' Связи - входящие данные
Rel(cookie_platform, recipe_sites, "Парсит рецепты, ингредиенты, изображения", "HTTP/Web Scraping")
Rel(cookie_platform, video_platforms, "Извлекает рецепты из видео через API", "REST API")
Rel(cookie_platform, nutrition_db, "Получает данные о нутриентах продуктов", "REST API")

' Связи - партнеры доставки
Rel(cookie_platform, x5_group, "Получает каталог готовой еды, отправляет заказы", "REST API")
Rel(cookie_platform, vkusvill, "Получает каталог, отправляет заказы", "REST API")
Rel(cookie_platform, sbermarket, "Интеграция с каталогом продуктов", "REST API")
Rel(cookie_platform, samokat, "Быстрая доставка ингредиентов", "REST API")

' Связи - ИИ
Rel(cookie_platform, openai, "Отправляет запросы для чат-консультаций", "REST API")
Rel(cookie_platform, anthropic, "Альтернативный провайдер LLM", "REST API")

' Связи - платежи и auth
Rel(cookie_platform, payment_gateway, "Обрабатывает подписки и платежи", "REST API")
Rel(cookie_platform, oauth_providers, "Аутентификация пользователей", "OAuth 2.0")

' Связи - аналитика и мониторинг
Rel(cookie_platform, analytics_systems, "Отправляет события пользователей", "HTTP/JavaScript SDK")
Rel(cookie_platform, monitoring, "Отправляет метрики, логи, ошибки", "HTTP/SDK")

' Связи - коммуникации
Rel(cookie_platform, email_service, "Отправляет email (подтверждения, рассылки)", "SMTP/REST API")
Rel(cookie_platform, push_service, "Отправляет push-уведомления", "FCM API")
Rel(cookie_platform, sms_service, "Отправляет SMS (верификация, алерты)", "REST API")

SHOW_LEGEND()

@enduml
